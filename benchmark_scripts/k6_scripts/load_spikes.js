// Generated by Cursor

import http from 'k6/http';
import { sleep, check } from 'k6';
import { BASE_URL, HEADERS } from './config.js';


export let options = {
  // Define stages with varying virtual users (VUs)
  stages: [
    // Warm-up: Gradually ramp up to baseline load
    { duration: '10s', target: 100 },   // Start with 10 users
    
    // Steady state: Maintain baseline load
    { duration: '10s', target: 100 },   
    
    // Sudden spike: Quick ramp up to high load
    { duration: '10s', target: 10000 },  // Sudden spike to 10000 users
    
    // Sustained peak: Maintain high load
    { duration: '10s', target: 10000 },
    
    // Recovery: Quick drop back to baseline
    { duration: '5s', target: 100 },
    
    // Verify stability: Maintain baseline after spike
    { duration: '10s', target: 100 },

    // Sudden spike: Quick ramp up to high load
    { duration: '10s', target: 10000 },  // Sudden spike to 10000 users
    
    // Sustained peak: Maintain high load
    { duration: '10s', target: 10000 },

    // Recovery: Quick drop back to baseline
    { duration: '5s', target: 100 },
    
    // Verify stability: Maintain baseline after spike
    { duration: '10s', target: 100 },
  ],
  thresholds: THRESHOLDS,
};

export default function() {
  const url = `${BASE_URL}/plaintext`;
  
  // Optional: Add headers, params or body data
  const params = {
    headers: {
      'Content-Type': 'application/json',
    },
  };
  
  // Make HTTP request
  const response = http.get(url, params);
  
  // Check if request was successful
  check(response, {
    'status is 200': (r) => r.status === 200,
    'response time < 200ms': (r) => r.timings.duration < 200,
  });
}